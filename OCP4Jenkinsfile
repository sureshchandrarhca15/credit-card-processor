node('maven') {
     def myRepo, gitCommit, gitBranch, shortGitCommit, previousGitCommit
     stage('Checkout') 
     {
        try 
		{
            myRepo = checkout scm
            gitCommit = myRepo.GIT_COMMIT
            gitBranch = myRepo.GIT_BRANCH
            shortGitCommit = "${gitCommit[0..10]}"
            previousGitCommit = sh(script: "git rev-parse ${gitCommit}~", returnStdout: true)
        }
        catch(Exception e) 
		{
            println "ERROR => Code Checkout failed, exiting..."
            throw e
        }
     }
     stage('Build') 
	 {
        try 
		{
	        sh """
            mvn clean install -Dmaven.test.skip=true
            """
           
        }
      catch (Exception e) 
	  {
        println "Failed to Maven Build - ${currentBuild.fullDisplayName}"
        throw e
      }
    }
	
	 stage('Unit Test') {
      try
  	    {
        
            sh """
              mvn test -Dmaven.test.skip=true
            """
        
        }
      catch (Exception e) {
        println "Failed to test - ${currentBuild.fullDisplayName}"
        throw e
      }
    }
}